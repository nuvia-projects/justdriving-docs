"use strict";(globalThis.webpackChunkjustdriving=globalThis.webpackChunkjustdriving||[]).push([[5022],{6739:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"data/flow","title":"Data Flow Diagrams","description":"This page describes how data flows through the Just Driving system for common use cases. It complements the ER diagrams by showing the sequence and direction of data movement across entities when typical workflows are executed.","source":"@site/docs/data/flow.md","sourceDirName":"data","slug":"/data/flow","permalink":"/docs/data/flow","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/data/flow.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"ER Diagrams","permalink":"/docs/data/er-diagram"},"next":{"title":"Indexing Strategies","permalink":"/docs/data/indexing"}}');var a=t(4848),r=t(8453);const o={sidebar_position:4},s="Data Flow Diagrams",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Student registration and school enrollment",id:"student-registration-and-school-enrollment",level:2},{value:"Booking creation and student assignment",id:"booking-creation-and-student-assignment",level:2},{value:"Lesson completion and signature",id:"lesson-completion-and-signature",level:2},{value:"Invoice creation and payment",id:"invoice-creation-and-payment",level:2},{value:"Notification and background jobs",id:"notification-and-background-jobs",level:2}];function c(e){const n={h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"data-flow-diagrams",children:"Data Flow Diagrams"})}),"\n",(0,a.jsx)(n.p,{children:"This page describes how data flows through the Just Driving system for common use cases. It complements the ER diagrams by showing the sequence and direction of data movement across entities when typical workflows are executed."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"Data flow diagrams focus on:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Which entities are read from and written to during a workflow."}),"\n",(0,a.jsx)(n.li,{children:"The order in which data is created or updated."}),"\n",(0,a.jsx)(n.li,{children:"Where background jobs, notifications, or external integrations fit into the flow."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Understanding these flows helps developers see how changes in one part of the system affect related entities and helps with debugging, performance optimization, and feature development."}),"\n",(0,a.jsx)(n.h2,{id:"student-registration-and-school-enrollment",children:"Student registration and school enrollment"}),"\n",(0,a.jsx)(n.p,{children:"This flow describes what happens when a new student signs up and is enrolled in a school."}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant User as Potential student\r\n    participant Web as Web controller\r\n    participant Student as Student entity\r\n    participant SchoolStudent as School-student link\r\n    participant Invoice as Student invoice\r\n    participant Email as Email queue\r\n\r\n    User->>Web: Submit registration form\r\n    Web->>Student: Create student record\r\n    Web->>SchoolStudent: Link student to school\r\n    Web->>Invoice: Create initial invoice (if applicable)\r\n    Web->>Email: Queue welcome email\r\n    Email--\x3e>Student: Send welcome and login info\r\n"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A new student record is created with contact and login details."}),"\n",(0,a.jsx)(n.li,{children:"The student is linked to a school via the school\u2013student join table."}),"\n",(0,a.jsx)(n.li,{children:"An initial invoice may be created (for example, signup fee or first course payment)."}),"\n",(0,a.jsx)(n.li,{children:"A welcome email with login credentials is queued and sent asynchronously."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"booking-creation-and-student-assignment",children:"Booking creation and student assignment"}),"\n",(0,a.jsx)(n.p,{children:"This flow describes how a teacher or school staff member creates a booking and assigns students to it."}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant Teacher as Teacher/School staff\r\n    participant Web as Web controller\r\n    participant Booking as Booking entity\r\n    participant BookingStudent as Booking-student link\r\n    participant Notification as Notification queue\r\n\r\n    Teacher->>Web: Create booking (date, time, type, location)\r\n    Web->>Booking: Store booking record\r\n    Teacher->>Web: Assign students to booking\r\n    Web->>BookingStudent: Create booking-student links\r\n    Web->>Notification: Queue confirmation email/SMS\r\n    Notification--\x3e>BookingStudent: Send notifications to students\r\n"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A booking is created with details such as date, time, teacher, booking type, and address."}),"\n",(0,a.jsx)(n.li,{children:"One or more students are assigned to the booking via the booking\u2013student link."}),"\n",(0,a.jsx)(n.li,{children:"Notifications (email and/or SMS) are queued to inform students of the new booking."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"lesson-completion-and-signature",children:"Lesson completion and signature"}),"\n",(0,a.jsx)(n.p,{children:"This flow describes what happens when a lesson or module is completed and signed off by both student and teacher."}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant Teacher as Teacher\r\n    participant Student as Student\r\n    participant Web as Web controller\r\n    participant Signature as Lesson plan module signature\r\n    participant Module as Lesson plan module\r\n    participant Notification as Notification queue\r\n\r\n    Teacher->>Web: Mark module as completed and sign\r\n    Web->>Signature: Create signature record (teacher)\r\n    Web->>Notification: Queue signature request to student\r\n    Notification--\x3e>Student: Send email/SMS to student\r\n    Student->>Web: Review and sign module\r\n    Web->>Signature: Update signature record (student)\r\n    Web->>Module: Mark module as fully signed\r\n"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The teacher completes a lesson plan module and signs it."}),"\n",(0,a.jsx)(n.li,{children:"A signature record is created with the teacher's signature and timestamp."}),"\n",(0,a.jsx)(n.li,{children:"The system notifies the student to review and sign the module."}),"\n",(0,a.jsx)(n.li,{children:"Once the student signs, the signature record is updated and the module is marked complete."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"invoice-creation-and-payment",children:"Invoice creation and payment"}),"\n",(0,a.jsx)(n.p,{children:"This flow describes how an invoice is created for a student, a payment is registered, and the student's balance is updated."}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant School as School staff\r\n    participant Web as Web controller\r\n    participant Invoice as Student invoice\r\n    participant InvoiceData as Student invoice data\r\n    participant Payment as Student payment\r\n    participant Balance as Student balance\r\n    participant Email as Email queue\r\n\r\n    School->>Web: Create invoice for student\r\n    Web->>Invoice: Create invoice record\r\n    Web->>InvoiceData: Add line items\r\n    Web->>Email: Queue invoice email to student\r\n    Email--\x3e>Student: Send invoice notification\r\n    Student->>Web: Make payment (online or recorded manually)\r\n    Web->>Payment: Create payment record\r\n    Web->>Balance: Update student balance\r\n    Web->>Email: Queue payment confirmation email\r\n    Email--\x3e>Student: Send payment receipt\r\n"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"An invoice is created with one or more line items describing services or fees."}),"\n",(0,a.jsx)(n.li,{children:"The student is notified via email."}),"\n",(0,a.jsx)(n.li,{children:"When payment is made (online via Stripe or recorded manually), a payment record is created."}),"\n",(0,a.jsx)(n.li,{children:"The student's balance is updated to reflect the payment."}),"\n",(0,a.jsx)(n.li,{children:"A payment confirmation is sent to the student."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"notification-and-background-jobs",children:"Notification and background jobs"}),"\n",(0,a.jsx)(n.p,{children:"Many flows in Just Driving trigger asynchronous work via queues. Common patterns include:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Email notifications"}),": Queued jobs send emails for confirmations, reminders, password resets, and invoices."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"SMS notifications"}),": Queued jobs send SMS messages via Twilio for booking reminders, cancellations, and urgent alerts."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"External API calls"}),": When integrating with platforms like e-teori.dk, findkoreskole.dk, or Stripe webhooks, jobs handle slow or unreliable network operations without blocking HTTP requests."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The flow for a notification is:"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant Controller as Controller\r\n    participant Queue as Queue (Redis)\r\n    participant Job as Notification job\r\n    participant External as External service (email/SMS)\r\n    Controller->>Queue: Dispatch notification job\r\n    Queue--\x3e>Job: Pick up job from queue\r\n    Job->>External: Send notification\r\n    External--\x3e>Job: Confirm delivery\r\n    Job->>Queue: Mark job complete\r\n"}),"\n",(0,a.jsx)(n.p,{children:"This pattern keeps the application responsive and allows failed jobs to be retried automatically."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var i=t(6540);const a={},r=i.createContext(a);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);